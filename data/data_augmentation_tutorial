

import albumentations as A
import cv2
import matplotlib.pyplot as plt
import os

image_folder = 'data/test_results'

def visualize(name,image):
    plt.figure(figsize=(10, 10))
    plt.axis('off')
    plt.imsave(os.path.join(image_folder, name), image)

# Declare an augmentation pipeline
transform = A.Compose([
    A.RandomCrop(width=256, height=256),
    A.HorizontalFlip(p=0.5),
    A.RandomBrightnessContrast(p=0.2),],
    additional_targets={
        "image1": "image",
        "image2": "image",
        "mask1" : "mask",
        "mask2" : "mask"
        })

# Read an image with OpenCV and convert it to the RGB colorspace
image = cv2.imread(os.path.join(image_folder,'test_image0.jpg'))
image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
image1 = cv2.imread(os.path.join(image_folder,'test_image1.jpg'))
image1 = cv2.cvtColor(image1, cv2.COLOR_BGR2RGB)
image2 = cv2.imread(os.path.join(image_folder,'test_image2.jpg'))
image2 = cv2.cvtColor(image2, cv2.COLOR_BGR2RGB)
visualize('img1_A.jpg',image)
visualize('img2_A.jpg',image1)
visualize('img3_A.jpg',image2)

# Augment an image
transformed = transform(image =image, image1=image, image2=image, mask=image1, mask1=image1, mask2=image1)#anoying need to use three,
print(transformed)
visualize('transform1.jpg',transformed['image'])
visualize('transform2.jpg',transformed['image1'])
visualize('transform3.jpg',transformed['image2']) 
visualize('mask1.jpg',transformed['mask'])
visualize('mask2.jpg',transformed['mask1'])
visualize('mask3.jpg',transformed['mask2'])